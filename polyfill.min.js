!function(a,b){"use strict";"function"==typeof define&&define.amd?define(b):"object"==typeof exports?module.exports=b():a.Polyfill=b()}(this,function(){"use strict";var a=function(a,b){if("indexOf"in a)return a.indexOf(b);for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1},b=function(b,c){return a(b,c)>-1},c=function(a,c){b(a,c)||a.push(c)},d=function(b,c){var d=a(b,c);d>-1&&b.splice(d,1)},e=function(a,b){for(var c=[],d=0,e=a.length;e>d;d++)c[d]=b(a[d]);return c},f=function(a,b,c){var d=b.split("."),e=d.pop(),f=d.join("."),a=g(f);return"object"==typeof a?(a[e]=c,!0):!1},g=function(a,b){if(""===b)return a;for(var c=b.split("."),d=c.length;"object"==typeof a&&d>i;)a=a[c[i]],i++;return a},h=function(a,b,c){return Array.prototype.slice.call(a,b,c)},j=function(){return this.__attach(),n.emit("attach",[this]),this},k=function(){this.__detach(),n.emit("detach",[this])},l=[],m={},n=function(a,b,c,d){switch(arguments.length){case 0:n.start();break;case 2:n.load(a,b);break;case 4:n.register(a,b,c,d)}return this};if(n.autoStart=!0,n.autoAttach=!0,n.__features=l,n.__listeners=m,n.load=function(a,b){return b&&this.add(a),this},n.remove=function(a){return d(l,a),this.emit("remove",[a]),this},n.add=function(a){return c(l,a),this.emit("add",[a]),this},n.loaded=function(a){return b(l,a)},n.register=function(a,b,c,d){return f(this,a,b),b.__attach=c,b.__detach=d,b.attach=j,b.detach=k,this.emit("register",[a,b,c,d]),this.autoAttach&&b.attach(),this},n.attach=function(a){var b=g(this,a);return b.attach(),this},n.detach=function(a){var b=g(this,a);b.detach()},n.run=n.call=function(a,b){var c=g(this,a);return c.apply(b,h(arguments,2)),this},n.start=function(){var a="polyfill.js?"+e(l,encodeURIComponent).join("&"),b=document.createElement("script");return b.setAttribute("type","text/javascript"),b.setAttribute("src",a),document.getElementsByTagName("head")[0].appendChild(b),this.emit("load",[b]),this},n.on=function(a,b){return m[a]||(m[a]=[]),c(m[a],b),this},n.off=function(a,b){return m[a]&&d(m[a],b),this},n.emit=function(a,b){var b=b||[],c=m[a];if(c)for(var d=0,e=c.length;e>d;d++)c[d].apply(this,b);return this},"function"==typeof window.onload)var o=window.onload;return window.onload=function(a){n.autoStart&&n.start(),o&&o(a)},n});